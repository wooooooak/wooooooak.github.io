---
layout: post
title: 코틀린 개발자는 null을 어떻게 바라봐야 하는가
category: Kotlin
tags: [kotlin, null, type_system]
comments: true
---

> **(널 포인터는) 내 10억 달러짜리 실수였다.** 1965년 당시, 나는 ALGOL W라는 객체 지향 언어에 쓰기 위해 포괄적인 타입 시스템을 설계하고 있었다. 내 원래 목표는 어떤 데이터를 읽든 항상 안전하도록 컴파일러가 자동으로 확인해 주는 것이었다. 그러나 나는 널 포인터를 집어넣으려는 유혹을 이길 수가 없었다. 그렇게 하는 게 훨씬 쉬웠기 때문이다. **이 결정은 셀 수도 없는 오류와 보안 버그, 시스템 다운을 낳았다. 지난 40년 동안 이러한 문제들 때문에 입은 고통과 손해는 10억 달러는 될 것이다.** - 토니 호어

`Null`이라는 단어를 보면 무슨 느낌이 드는가. 쳐다보기도 싫고, 스트레스를 받고, 두렵고, 피하고 싶다면 당신은 아마 높은 확률로 코틀린 개발자는 아닐 것이다(그래야만 한다).

Java를 프로로써 다뤄본 적은 없어도 한 번쯤은 모두 접해보았을 거라 생각한다. 나 역시도 자바를 다뤄본 적이 있다. 그때를 생각해보면, `null`은 항상 회피와 두려움의 대상이었다. `NullPointException`을 마주칠까 두려워했었다. 그래서 `null`을 어떻게 다뤄야 하는지에 대한 레퍼런스를 검색하곤 했었다.

## Java에서 null을 다루는 몇 가지 지침

지금도 Java와 null을 함께 검색하면, null을 다룰때 권장하는 지침들이 나온다. 아래는 대표적인 3가지 지침이다.

1. API에 null을 최대한 쓰지 말아라.
2. 초기화를 명확히 해라.
3. Optional을 잘 익혀 사용해라.

3번 같은 경우 실제로 JAVA코드에서 많이 보이고 있는것 같다.

그러나 나는 위의 3가지 지침들이 안타깝게 느껴진다. 위의 지침들은 null을 회피하게 만들거나, 많은 boilerplate 코드들을 필요로 하기 때문이다. 자바를 다룬다면 지키는게 좋은 사항들이지만 아쉬운건 어쩔 수 없다.

## null의 본질

null의 본질을 생각해보자. 자바의 지침들이 말하고 있는 것 처럼 null은 정말 나쁜놈이며, 피해야할 대상일까?

나는 그렇게 생각하지 않는다. 현대 많은 programming lanaguage 디자이너들도 그렇게 생각하지 않는것 같다.

이 글의 가장 첫 부분에 토니 호어의 말을 인용했다.

> **(널 포인터는) 내 10억 달러짜리 실수였다.** 1965년 당시, 나는 ALGOL W라는 객체 지향 언어에 쓰기 위해 포괄적인 타입 시스템을 설계하고 있었다. 내 원래 목표는 어떤 데이터를 읽든 항상 안전하도록 컴파일러가 자동으로 확인해 주는 것이었다. 그러나 나는 널 포인터를 집어넣으려는 유혹을 이길 수가 없었다. 그렇게 하는 게 훨씬 쉬웠기 때문이다. **이 결정은 셀 수도 없는 오류와 보안 버그, 시스템 다운을 낳았다. 지난 40년 동안 이러한 문제들 때문에 입은 고통과 손해는 10억 달러는 될 것이다.** - 토니 호어

이 글을 자세히 보자. 토니 호어는 null pointer, 즉 null을 가르키는 것이 실수이지 null이라는 그 자체의 개념적인 문제라고 한 것이 아니다. 소프트웨어는 어찌되었든 값이 없음을 나타낼 무언가가 필요하고, 실제로 **null은 값이 없음을 나타내는 가장 명확하고 효율적인 방법이다.** 따라서 null은 null의 의미를 살려서 같이 가져가야 할 존재이지, 두려움과 회피의 대상이 아니라고 본다.

결국 자바 진영에서 "null을 회피하는 지침"들이 나온다는 것은, 자바 타입시스템 셜계에 결함이 있다고 볼 수 밖에 없다. 왜 자바 타입 시스템이 명백한 오류인지를 조금 더 구체적으로 증명해 보자.

## Type이란?

타입 시스템을 다루기 전에 타입이 무엇인지를 명확히 알아야 한다. 그렇다면 객체지향 관점에서 타입은 무엇일까?

**타입**이란, 객체의 퍼블릭 메서드들, 즉 퍼블릭 인터페이스의 집합을 의미한다.

![image](https://user-images.githubusercontent.com/18481078/97304671-677c5400-189f-11eb-87ce-921f433af570.png)
예를들어 A라는 객체에 날기, 먹기, 숨쉬기 라는 퍼블릭 메서드가 있다면, 이 것을 하나의 집합으로 보아 타입으로 분류할 수 있다. 이 세가지 메서드 집합을 Bird라는 타입으로 분류해보자. B와 C역시 동일한 퍼블릭 메서드 집합을 구현하고 있으므로 Bird 타입이라고 볼 수 있게 된다. 여기서 중요한 점은, 객체가 어떤 상태를 가지고 있는지(어떤 지역변수를 가지고 있는지)는 관심 대상이 아니다. 오로지 객체의 퍼블릭 인터페이스를 보고 타입을 정한다.
**즉 객체지향 관점에서 Type이란, 객체의 퍼블릭 인터페이스의 집합이다.**

### 실생활에서의 Type

아주 간단한 실생활의 예를 들어보자. 우리는 가끔 이런 말을 하곤 한다.

> 너 되게 짜증나는 타입이구나??
> 이 말에는 엄청나게 객체지향적인 관점이 담겨있다.
> "너의 속사정은 모르겠지만, 너는 굉장히 사람을 짜증나게 하는 public 메서드를 가지고 있구나"라고 판단하여 짜증 유발자 타입으로 분류하곤 한다.
> 이렇듯 객체지향에서의 타입과 실생활에서 말하는 type은 거의 동일하다. 어려운 개념이 아니다.

타입이 무엇인지 알아보았으니 타입 시스템과 연관시켜보자.

## Type System

![image](https://user-images.githubusercontent.com/18481078/97305313-47996000-18a0-11eb-808a-4fdfd3706cea.png)
